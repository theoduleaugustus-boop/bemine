<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>üíò Valentine</title>
  <style>
    :root{
      --bg1:#fff0f6; --bg2:#ffe0ee; --ink:#2b1b22;
      --pink:#ff2f78; --pink2:#ff6fa1;
      --card:#ffffffcc; --shadow: 0 18px 55px rgba(0,0,0,.12);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;color:var(--ink)}
    body{
      overflow:hidden;
      background:
        radial-gradient(1200px 800px at 20% 10%, var(--bg2), transparent 55%),
        radial-gradient(1000px 700px at 80% 20%, #ffeaf2, transparent 60%),
        linear-gradient(135deg, var(--bg1), #fff);
    }

    /* floating bg hearts */
    #bgHearts{position:fixed;inset:0;pointer-events:none;overflow:hidden;opacity:.24;z-index:0}
    .bg-heart{position:absolute;bottom:-10vh;font-size:18px;animation:floatUp linear infinite;opacity:.9}
    @keyframes floatUp{
      0%{transform:translateY(0) translateX(0) rotate(0deg);opacity:0}
      10%{opacity:.9}
      100%{transform:translateY(-120vh) translateX(20px) rotate(18deg);opacity:0}
    }

    .wrap{position:relative;height:100%;display:flex;align-items:center;justify-content:center;padding:18px;z-index:1}
    .card{
      width:min(620px,94vw);
      background:var(--card);
      border:1px solid rgba(255,255,255,.6);
      border-radius:24px;
      box-shadow:var(--shadow);
      backdrop-filter: blur(12px);
      padding:26px 22px 20px;
      text-align:center;
      position:relative;
    }
    .chip{
      display:inline-flex;align-items:center;gap:10px;
      padding:10px 14px;background:#fff;border-radius:999px;
      box-shadow:0 10px 30px rgba(0,0,0,.08);
      font-weight:1000;
    }
    h1{margin:14px 0 8px;font-size:clamp(22px,3.2vw,34px);letter-spacing:-.02em}
    p{margin:0 0 16px;opacity:.85}

    .toast{
      min-height:40px;
      margin:12px 0 22px;
      padding:0 6px;
      position:relative;
      z-index:1;
      font-weight:900;
    }

    .row{
      display:flex;
      gap:12px;
      justify-content:center;
      align-items:center;
      flex-wrap:wrap;
      position:relative;
      z-index:2;
      padding-top:8px;
    }

    button{
      border:0;border-radius:16px;padding:14px 18px;font-size:18px;cursor:pointer;
      transition:transform .15s ease, filter .15s ease, opacity .25s ease;
      user-select:none;-webkit-tap-highlight-color:transparent;
      box-shadow:0 12px 30px rgba(0,0,0,.10);
      min-width:170px;
      font-weight:1000;
    }
    #yesBtn{
      background:linear-gradient(90deg,var(--pink),var(--pink2));
      color:#fff;
      transform-origin:center bottom;
      position:relative;
      z-index:2;
    }
    #noBtn{
      background:#fff;
      border:1px solid rgba(0,0,0,.10);
      color:#222;
      position:relative;
      z-index:1;
    }
    button:active{transform:scale(.98)}
    .hidden{opacity:0;pointer-events:none}

    /* YES heart beat */
    #yesHeart{
      display:inline-block;margin-left:6px;
      transform-origin:center;
      animation:heartBeat 1.2s ease-in-out infinite;
    }
    @keyframes heartBeat{
      0%,100%{transform:scale(1)}
      50%{transform:scale(1.25)}
    }

    /* NO moves around the SCREEN (not cramped in the row) */
    #noBtn.runaway{
      position:fixed;     /* screen space */
      z-index:9999;
      pointer-events:auto;
    }

    /* hearts burst on YES */
    .pop-heart{
      position:fixed;font-size:20px;pointer-events:none;
      animation:popUp 1.35s ease-out forwards;
      z-index:9997;
    }
    @keyframes popUp{
      0%{transform:translateY(0) scale(0.8);opacity:0}
      20%{opacity:1}
      100%{transform:translateY(-120px) scale(1.35);opacity:0}
    }

    /* Vinyl (same page, appears after YES; no auto-scroll) */
    #vinylArea{
      margin-top:18px;
      display:none;
    }
    #vinylArea.show{display:block;}
    #vinylCase{
      width:240px;
      height:160px;
      border-radius:18px;
      background:linear-gradient(135deg,#fff,#ffe6f1);
      border:2px solid rgba(0,0,0,.08);
      box-shadow:0 18px 40px rgba(0,0,0,.18);
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      gap:6px;
      cursor:pointer;
      user-select:none;
      -webkit-tap-highlight-color:transparent;
      position:relative;
      overflow:hidden;
      margin: 0 auto;
    }
    #vinylCase .label{
      font-weight:1000;
      font-size:14px;
      padding:6px 10px;
      border-radius:999px;
      background:#fff;
      border:1px solid rgba(0,0,0,.06);
    }
    #vinylCase .mini{
      font-size:12px;
      opacity:.8;
      font-weight:800;
    }
    #lid{
      position:absolute;left:0;top:0;width:100%;height:100%;
      transform-origin:left center;
      pointer-events:none;
    }
    #vinylCase.open #lid{ animation: lidOpen .35s ease forwards; }
    @keyframes lidOpen{ from{transform:rotateY(0deg)} to{transform:rotateY(-25deg)} }

    #record{
      width:86px;height:86px;border-radius:50%;
      background: radial-gradient(circle at 50% 50%, #000 0 18%, #222 18% 34%, #111 34% 52%, #000 52% 100%);
      box-shadow: inset 0 0 0 4px rgba(255,255,255,.06);
      position:absolute; right:18px; top:38px;
      opacity:0;
      transform: translateX(-24px) scale(.95);
      transition: opacity .25s ease, transform .35s ease;
    }
    #record::after{
      content:"";
      position:absolute; inset:34px; border-radius:50%;
      background:linear-gradient(90deg,var(--pink),var(--pink2));
      box-shadow:0 0 0 3px rgba(255,255,255,.15);
    }
    #vinylCase.open #record{ opacity:1; transform: translateX(0) scale(1); }
    #record.spin{ animation: spin 1.05s linear infinite; }
    @keyframes spin{
      from{ transform: translateX(0) scale(1) rotate(0deg); }
      to{ transform: translateX(0) scale(1) rotate(360deg); }
    }

    .note{
      position:fixed;
      z-index:9200;
      font-size:18px;
      pointer-events:none;
      animation:noteFloat 2.2s ease-in forwards;
      opacity:.95;
    }
    @keyframes noteFloat{
      0%{transform:translateY(0) translateX(0) scale(.9);opacity:0}
      15%{opacity:1}
      100%{transform:translateY(-160px) translateX(var(--dx)) scale(1.2);opacity:0}
    }
  </style>
</head>
<body>
  <div id="bgHearts"></div>

  <div class="wrap">
    <div class="card">
      <div class="chip">üíò To the love of my life Sherkima</div>
      <h1>Will you be my Valentine?</h1>
      <p>I‚Äôm asking nicely‚Ä¶ but the buttons might disagree üòå</p>

      <div class="toast" id="toast"></div>

      <div class="row" id="btnRow">
        <button id="yesBtn">YES <span id="yesHeart">üíù</span></button>
        <button id="noBtn">No üôÉ</button>
      </div>

      <div id="vinylArea">
        <p style="margin:14px 0 10px; font-weight:1000;">One more thing‚Ä¶ üòåüé∂</p>
        <div id="vinylCase" role="button" aria-label="Vinyl surprise">
          <div class="label" id="vinylLabel">üéÅ Click me for a surprise</div>
          <div class="mini" id="vinylMini">I promise it‚Äôs cute.</div>
          <div id="lid" aria-hidden="true"></div>
          <div id="record" aria-hidden="true"></div>
        </div>
      </div>
    </div>
  </div>

  <audio id="audio" preload="auto">
    <source src="song.m4a" type="audio/mp4">
  </audio>

<script>
  // bg hearts
  const bgHearts = document.getElementById("bgHearts");
  const heartChars = ["üíó","üíñ","üíû","üíï","üíò"];
  function spawnBgHeart(){
    const h = document.createElement("div");
    h.className = "bg-heart";
    h.textContent = heartChars[Math.floor(Math.random()*heartChars.length)];
    h.style.left = (Math.random()*100) + "vw";
    const dur = 10 + Math.random()*10;
    h.style.animationDuration = dur + "s";
    h.style.animationDelay = (-Math.random()*dur) + "s";
    h.style.fontSize = (14 + Math.random()*18) + "px";
    bgHearts.appendChild(h);
    setTimeout(()=>h.remove(), dur*1000);
  }
  for(let i=0;i<14;i++) spawnBgHeart();
  setInterval(spawnBgHeart, 900);

  const toast = document.getElementById("toast");
  const yesBtn = document.getElementById("yesBtn");
  const noBtn  = document.getElementById("noBtn");
  const yesHeart = document.getElementById("yesHeart");
  const audioEl = document.getElementById("audio");

  const vinylArea = document.getElementById("vinylArea");
  const vinylCase = document.getElementById("vinylCase");
  const vinylLabel = document.getElementById("vinylLabel");
  const vinylMini = document.getElementById("vinylMini");
  const record = document.getElementById("record");

  const noTexts = [
    "Wrong button üòå",
    "Try again, love.",
    "‚ÄòNO‚Äô is running away maybe try ‚ÄòYES‚Äô?‚Ä¶",
    "You still was able to click no wow I‚Äôm impressed",
    "I think your finger slipped this time. It happens.",
    "Plot twist: No decided to find its own valentine"
  ];
  let noCount = 0;
  const NO_LIMIT = 6;
  let dodgeEnabled = false;

  // NO physics (screen space)
  let noX = null, noY = null;
  let vx = 0, vy = 0;
  let rafId = null;
  let mouseX = window.innerWidth/2, mouseY = window.innerHeight/2;

  function clamp(n,min,max){ return Math.max(min, Math.min(max,n)); }

  function initNoFixedFromCurrent(){
    const r = noBtn.getBoundingClientRect();
    noX = r.left;
    noY = r.top;
    noBtn.classList.add("runaway");
    noBtn.style.left = noX + "px";
    noBtn.style.top  = noY + "px";
  }

  function setNoPos(x, y){
    const pad = 10; // lets it get close to edges
    const w = noBtn.offsetWidth || 170;
    const h = noBtn.offsetHeight || 56;
    const maxX = window.innerWidth  - w - pad;
    const maxY = window.innerHeight - h - pad;
    noX = clamp(x, pad, maxX);
    noY = clamp(y, pad, maxY);
    noBtn.style.left = noX + "px";
    noBtn.style.top  = noY + "px";
  }

  function updateYesEffects(){
    const scaleYes = 1 + (noCount * 0.14);
    yesBtn.style.transform = `scale(${scaleYes})`;
    const duration = Math.max(0.28, 1.2 - (noCount * 0.18));
    yesHeart.style.animationDuration = duration + "s";
  }

  function updateNoEffects(){
    // NO gets smaller each click
    const scaleNo = Math.max(0.55, 1 - (noCount * 0.08));
    noBtn.style.transform = `scale(${scaleNo})`;
  }

  window.addEventListener("mousemove", (e)=>{
    mouseX = e.clientX;
    mouseY = e.clientY;
  });

  function startRunaway(){
    if (rafId) return;

    function step(){
      if (noBtn.classList.contains("hidden")){
        rafId = null;
        return;
      }
      if (!dodgeEnabled){
        rafId = requestAnimationFrame(step);
        return;
      }
      if (noX === null) initNoFixedFromCurrent();

      // speed increases as she clicks NO
      const MAX_SPEED = 14 + (noCount * 2.2);    // faster each click
      const FRICTION  = 0.84;                    // smooth
      const TRIGGER   = 210;                     // runs when cursor gets close
      const BOOST     = 1.35 + (noCount * 0.08); // stronger push each click

      const w = noBtn.offsetWidth || 170;
      const h = noBtn.offsetHeight || 56;
      const bx = noX + w/2;
      const by = noY + h/2;

      const dx = bx - mouseX;
      const dy = by - mouseY;
      const dist = Math.max(1, Math.hypot(dx, dy));

      if (dist < TRIGGER){
        const strength = (TRIGGER - dist) / TRIGGER;
        const ux = dx / dist;
        const uy = dy / dist;
        vx += ux * (MAX_SPEED * strength * BOOST);
        vy += uy * (MAX_SPEED * strength * BOOST);
      }

      vx *= FRICTION;
      vy *= FRICTION;

      const vLen = Math.max(1, Math.hypot(vx, vy));
      if (vLen > MAX_SPEED){
        vx = (vx / vLen) * MAX_SPEED;
        vy = (vy / vLen) * MAX_SPEED;
      }

      let nextX = noX + vx;
      let nextY = noY + vy;

      // keep on screen & bounce
      const pad = 10;
      const maxX = window.innerWidth  - w - pad;
      const maxY = window.innerHeight - h - pad;
      if (nextX < pad || nextX > maxX) { vx *= -0.65; nextX = clamp(nextX, pad, maxX); }
      if (nextY < pad || nextY > maxY) { vy *= -0.65; nextY = clamp(nextY, pad, maxY); }

      setNoPos(nextX, nextY);

      rafId = requestAnimationFrame(step);
    }
    rafId = requestAnimationFrame(step);
  }

  // Start dodging only when she "targets" NO (like first versions)
  noBtn.addEventListener("mouseenter", ()=>{
    if (dodgeEnabled) return;
    dodgeEnabled = true;
    initNoFixedFromCurrent();
    startRunaway();
  });

  noBtn.addEventListener("click", ()=>{
    noCount++;
    toast.textContent = noTexts[Math.min(noCount-1, noTexts.length-1)];
    updateYesEffects();
    updateNoEffects();

    // enable dodge on first click too (mobile has no hover)
    if (!dodgeEnabled){
      dodgeEnabled = true;
      initNoFixedFromCurrent();
      startRunaway();
    }

    // after limit, hide no
    if (noCount >= NO_LIMIT){
      noBtn.classList.add("hidden");
    }
  });

  function burstHeartsFrom(el){
    const rect = el.getBoundingClientRect();
    const cx = rect.left + rect.width/2;
    const cy = rect.top + rect.height/2;
    for(let i=0;i<10;i++){
      const h = document.createElement("div");
      h.className = "pop-heart";
      h.textContent = heartChars[Math.floor(Math.random()*heartChars.length)];
      h.style.left = (cx + (Math.random()*120-60)) + "px";
      h.style.top  = (cy + (Math.random()*30)) + "px";
      document.body.appendChild(h);
      setTimeout(()=>h.remove(), 1350);
    }
  }

  yesBtn.addEventListener("click", ()=>{
    burstHeartsFrom(yesBtn);
    toast.textContent = "Yessss üòåüíó Smart choice. I knew you were my Valentine.";
    yesHeart.style.animation = "none";
    vinylArea.classList.add("show");   // appears like the first vibe (no auto-scroll)
  });

  // Vinyl click: remove prompt, open, slide record, spin, notes, play
  let notesTimer = null;
  function startNotes(){
    if (notesTimer) return;
    notesTimer = setInterval(()=>{
      const note = document.createElement("div");
      note.className = "note";
      note.textContent = ["‚ô™","‚ô´","‚ô¨","‚ô©"][Math.floor(Math.random()*4)];
      const r = vinylCase.getBoundingClientRect();
      note.style.left = (r.left + r.width/2 + (Math.random()*60-30)) + "px";
      note.style.top  = (r.top + 35 + (Math.random()*30)) + "px";
      note.style.setProperty("--dx", (Math.random()*100-50) + "px");
      document.body.appendChild(note);
      setTimeout(()=>note.remove(), 2200);
    }, 240);
  }

  vinylCase.addEventListener("click", async ()=>{
    vinylLabel.classList.add("hidden");
    vinylMini.classList.add("hidden");
    vinylCase.classList.add("open");
    record.classList.add("spin");
    startNotes();
    try{ await audioEl.play(); } catch(e){ /* ignore */ }
  });

  window.addEventListener("resize", ()=>{
    if (!dodgeEnabled || noX === null) return;
    setNoPos(noX, noY);
  });
</script>
</body>
</html>
